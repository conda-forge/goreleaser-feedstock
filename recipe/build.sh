#!/usr/bin/env bash

set -o xtrace -o nounset -o pipefail -o errexit

go build -buildmode=pie -trimpath -o=${PREFIX}/bin/goreleaser -ldflags="-s -w -X main.Version=${PKG_VERSION}"
go-licenses save . --save_path=license-files --ignore github.com/mattn/go-localereader --ignore vendor/golang.org/x/sys/unix --ignore vendor/golang.org/x/sys/cpu --ignore github.com/cloudflare/circl/dh/x25519 --ignore github.com/ipfs/bbloom --ignore github.com/multiformats/go-base36 --ignore debug/macho --ignore encoding/csv --ignore expvar --ignore go/build --ignore go/constant --ignore go/format --ignore go/scanner --ignore go/types --ignore mime/quotedprintable --ignore net --ignore runtime --ignore strings --ignore testing --ignore text --ignore time --ignore crypto --ignore regex --ignore encoding --ignore compress --ignore hash --ignore go --ignore internal --ignore unicode --ignore archive --ignore container --ignore os --ignore log --ignore html --ignore image --ignore flag --ignore github.com/pjbgf/sha1cd --ignore github.com/klauspost/compress --ignore github.com/cespare/xxhash --ignore embed --ignore cmp --ignore bytes --ignore errors --ignore vendor/golang.org/x/net/http/httpguts --ignore vendor/golang.org/x/net/http/httpproxy --ignore vendor/golang.org/x/net/http2/hpack --ignore vendor/golang.org/x/net/idna --ignore mime --ignore github.com/envoyproxy/protoc-gen-validate/validate --ignore lukechampine.com/blake3 --ignore github.com/klauspost/cpuid --ignore debug/dwarf --ignore bufio --ignore context --ignore database/sql/driver --ignore fmt --ignore vendor/golang.org/x/text --ignore io --ignore iter --ignore maps --ignore math --ignore path --ignore reflect --ignore slices --ignore sort --ignore strconv --ignore sync --ignore syscall --ignore unique --ignore vendor/golang.org/x/net/dns/dnsmessage --ignore github.com/cloudflare/circl/math --ignore github.com/cloudflare/circl/dh --ignore vendor/golang.org/x/crypto/cryptobyte --ignore vendor/golang.org/x/crypto/cryptobyte/asn1
